<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Dara Form</title>
<script defer src="dara.form.js"></script></head>

<body onload="formObj.load()">
  <div>
    <div class="form-button">
      <button type="button" onclick="formObj.addItem()">Add</button>
      <button type="button" onclick="formObj.getValue()">getValue</button>
      <button type="button" onclick="formObj.getValuePromise()">getValue(true)</button>
      <button type="button" onclick="formObj.setValue()">setValue()</button>
      <button type="button" onclick="formBuilder.isValidForm()">valid check</button>
      <button type="button" onclick="formBuilder.resetForm()">Reset</button>
      <button type="button" onclick="formObj.setFieldItems()">setFieldItems</button>
    </div>
  </div>

  <div style="padding: 0px 20px">
    <form id="formArea"></form>
  </div>
</body>

</html>
<style>
  .form-button {
    text-align: center;
  }
</style>
<script>
  var formInfo = {
    message: "This value is not valid",
    //mode: 'vertical',
    //autoFocus: false,
    style: {
      //width: '600px',
      position: 'left-left',
      labelWidth: '3'

    },
    // form load 이후 호출. 
    onMounted: function () {
      console.log(this)
    },
    message: {
      empty: "{name} 필수 입력사항입니다.",
      string: {
        minLength: "{size} 글자 이상 입력해야합니다.",
        maxLength: "{size} 글자 이상 입력할 수 없습니다.",
      },
      number: {
        minimum: "{size} 보다 커야 합니다",
        miximum: "{size} 보다 커야 합니다",
      },
      regexp: {
        email: "이메일이 유효하지 않습니다.",
        url: "URL이 유효하지 않습니다.",
      },
    },
    fields: [
      {
        name: "hiddenMode",
        renderType: "hidden",
        defaultValue: "asdf",
      },

      {
        name: "age",
        label: "나이",
        required: true,
        disabled: true,
        renderType: "number",
        defaultValue: 5,
      },
      {
        name: "sex",
        label: "성별",
        required: true,
        renderType: "dropdown",
        listItem: {
          list: [
            { label: "남", value: "Y", selected: true, disabled: true },
            { label: "여", value: "X" },
          ],
        },
      },
      {
        name: "picture",
        label: "사진",
        renderType: "file",
        listItem: {
          list: [
          ],
        },
      },


    ],
  };

  var rowIdx = 0;
  var formBuilder;
  var formObj = {
    load: () => {
      formBuilder = new DaraForm("#formArea", formInfo);
    },
    addItem: () => {
      rowIdx += 1;
      formBuilder.addField({
        name: `addItem${rowIdx}`,
        label: `추가컬럼${rowIdx}`,
        maxLength: 100,
        required: true,
      });
    },
    getValue: () => {
      alert(JSON.stringify(formBuilder.getValue()));
    },
    getValuePromise: () => {
      formBuilder
        .getFormDataValue(true)
        .then((aa) => {
          console.log(aa);

          for (let [name, value] of aa.entries()) {
            console.log(`${name} :  `, value);
          }

          alert("form data console 확인");
        })
        .catch((e) => {
          alert(e.message);
        });
    },
    setFieldItems: () => {
      formBuilder.setFieldItems("picture", [
        { fileId: "test1", fileName: "aaa.zip" },
        { fileId: "test2", fileName: "bbb.zip" },
      ]);
      formBuilder.setValue({ sex: "X" });
    },
    setValue: () => {
      let val = formBuilder.getValue();

      val.picture = {};

      formBuilder.setValue(val);

    }
  };
</script>