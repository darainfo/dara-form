<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Dara Form</title>
  <script defer src="dara.form.js"></script></head>

  <body onload="formObj.load()">
    <div>
      <div class="form-button">
        <button type="button" onclick="formObj.addItem()">Add</button>
        <button type="button" onclick="formObj.getValue()">getValue</button>
        <button type="button" onclick="formObj.getValuePromise()">getValue(true)</button>
        <button type="button" onclick="formBuilder.isValidForm()">valid check</button>
        <button type="button" onclick="formBuilder.resetForm()">Reset</button>
        <button type="button" onclick="formObj.setFieldItems()">setFieldItems</button>
      </div>
    </div>

    <div style="padding: 0px 20px">
      <form id="formArea"></form>
    </div>
  </body>
</html>
<style>
  .form-button {
    text-align: center;
  }
</style>
<script>
  var formInfo = {
    message: "This value is not valid",
    mode: "horizontal",
    //mode: 'vertical',
    //width: '600px',
    //autoFocus: false,
    labelStyle: {
      width: "150px",
      align: "right",
    },
    message: {
      empty: "{name} 필수 입력사항입니다.",
      string: {
        minLength: "{size} 글자 이상 입력해야합니다.",
        maxLength: "{size} 글자 이상 입력할 수 없습니다.",
      },
      number: {
        minimum: "{size} 보다 커야 합니다",
        miximum: "{size} 보다 커야 합니다",
      },
      regexp: {
        email: "이메일이 유효하지 않습니다.",
        url: "URL이 유효하지 않습니다.",
      },
    },
    fields: [
      {
        name: "hiddenMode",
        renderType: "hidden",
        defaultValue: "asdf",
      },
      {
        name: "uid",
        label: "아이디",
        tooltip: "아이디를 넣어주세요.",
        description: "설명설명설명",
        placeholder: "아이디를 넣어주세요.",
        //required: true,
        rule: {
          minLength: 3,
          maxLength: 100,
        },
        validator: (param) => {},
      },
      {
        name: "uname",
        label: "이름",
        required: true,
        rule: {
          minLength: 2,
          maxLength: 100,
        },
        onChange: (arg) => {
          console.log(arg);
        },
      },

      {
        name: "picture",
        label: "사진",
        renderType: "file",
        fileDownload: (item) => {
          console.log(item);
        },
      },
      ,
      {
        name: "dropdown",
        label: "드랍다운",
        renderType: "dropdown",
        required: true,
        listItem: {
          labelField: "{{label}}({{value}})",
          valueField: "value",
          list: [
            { value: "111", label: "AAA" },
            { value: "222", label: "BBB" },
          ],
        },
        onChange: function (a) {
          console.log(a);
        },
      },
      {
        name: "birth2",
        label: "생년월일2",
        required: true,
        renderType: "date",
        customOptions: {
          isEmbed: false,
          mode: "datetime",
          initialDate: new Date(),
        },
        onChange: (arg) => {
          console.log(arg);
        },
      },
      {
        label: "주소",
        viewMode: "horizontal-row", // 'vertical , horizontal'
        children: [
          {
            name: "newAddress",
            // label: "신규주소여부",

            required: true,
            renderType: "checkbox",
            listItem: {
              list: [{ label: "option1", value: "Y", selected: true }],
            },
            onChange: (arg) => {
              console.log(arg);
            },
          },
          {
            name: "address",
            label: "주소",
            hideLabel: true,
            required: true,
            rule: {
              minLength: 2,
              maxLength: 100,
            },
            conditional: {
              show: true,
              custom: function () {
                return true;
              },
            },
          },
          {
            name: "address2",
            label: "주소1",
            hideLabel: true,
            required: true,
            rule: {
              minLength: 2,
              maxLength: 100,
            },
            conditional: {
              show: false,
              field: "newAddress",
              eq: true,
              //custom?: OptionCallback
            },
          },
          {
            name: "hiddenMode1",
            renderType: "text",
            label: "주소 하위1",
            childLabelWidth: "10%",
            viewMode: "horizontal", // 'vertical , horizontal, horizontal-row'
            hideLabel: true,
            children: [
              {
                name: "address22222",
                label: "주소1",
                labelWidth: "150px",
                renderType: "text",
              },
              {
                name: "address222333322",
                label: "주소2",
                renderType: "text",
              },
            ],
          },
          {
            label: "버튼",
            hideLabel: true,
            renderType: "button",
            onClick: (arg) => {
              console.log(arg);
            },
          },
        ],
      },
      {
        label: "비밀번호",
        viewMode: "vertical",
        conditional: {
          show: true,
          custom: function () {
            return false;
          },
        },
        children: [
          {
            name: "upw",
            label: "비밀번호",
            labelStyle: {
              hide: true,
            },
            renderType: "password",
            regexpType: "number-char",
            rule: {
              minLength: 3,
            },
            different: {
              field: "uid",
              message: "아이디와 달라야 합니다.",
            },
          },
          {
            name: "confirmUpw",
            label: "확인 비밀번호",
            labelStyle: {
              hide: true,
            },
            renderType: "password",
            identical: {
              field: "upw",
              message: "비밀번호가 같아야합니다.",
            },
          },
        ],
      },
    ],
  };

  var rowIdx = 0;
  var formBuilder;
  var formObj = {
    load: () => {
      formBuilder = new DaraForm("#formArea", formInfo);
    },
    addItem: () => {
      rowIdx += 1;
      formBuilder.addField({
        name: `addItem${rowIdx}`,
        label: `추가컬럼${rowIdx}`,
        maxLength: 100,
        required: true,
      });
    },
    getValue: () => {
      alert(JSON.stringify(formBuilder.getValue()));
    },
    getValuePromise: () => {
      formBuilder
        .getFormDataValue(true)
        .then((aa) => {
          console.log(aa);

          for (let [name, value] of aa.entries()) {
            console.log(`${name} :  ${value}`);
          }

          alert(JSON.stringify(aa));
        })
        .catch((e) => {
          alert(e.message);
        });
    },
    setFieldItems: () => {
      formBuilder.setFieldItems("picture", [
        { fileId: "test1", fileName: "aaa.zip" },
        { fileId: "test2", fileName: "bbb.zip" },
      ]);
    },
  };
</script>
