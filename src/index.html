<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Dara Form</title>
  </head>

  <body onload="formObj.load()">
    <div>
      <div class="form-button">
        <button type="button" onclick="formObj.addItem()">Add</button>
        <button type="button" onclick="formObj.getValue()">getValue</button>
        <button type="button" onclick="formObj.getValuePromise()">getValue(true)</button>
        <button type="button" onclick="formBuilder.isValidForm()">valid check</button>
        <button type="button" onclick="formBuilder.resetForm()">Reset</button>
        <button type="button" onclick="formObj.setFieldItems()">setFieldItems</button>
      </div>
    </div>

    <div style="padding: 0px 20px">
      <form id="formArea"></form>
    </div>
  </body>
</html>
<style>
  .form-button {
    text-align: center;
  }
</style>
<script>
  var formInfo = {
    message: "This value is not valid",
    mode: "horizontal",
    //mode: 'vertical',
    //width: '600px',
    //autoFocus: false,
    labelStyle: {
      width: "150px",
      align: "right",
    },
    message: {
      empty: "{name} 필수 입력사항입니다.",
      string: {
        minLength: "{size} 글자 이상 입력해야합니다.",
        maxLength: "{size} 글자 이상 입력할 수 없습니다.",
      },
      number: {
        minimum: "{size} 보다 커야 합니다",
        miximum: "{size} 보다 커야 합니다",
      },
      regexp: {
        email: "이메일이 유효하지 않습니다.",
        url: "URL이 유효하지 않습니다.",
      },
    },
    fields: [
      {
        name: "hiddenMode",
        renderType: "hidden",
        defaultValue: "asdf",
      },
      {
        name: "uid",
        label: "아이디",
        tooltip: "아이디를 넣어주세요.",
        description: "설명설명설명",
        placeholder: "아이디를 넣어주세요.",
        //required: true,
        rule: {
          minLength: 3,
          maxLength: 100,
        },
        validator: (param) => {},
      },
      {
        name: "uname",
        label: "이름",
        required: true,
        rule: {
          minLength: 2,
          maxLength: 100,
        },
        onChange: (arg) => {
          console.log(arg);
        },
      },
      {
        name: "age",
        label: "나이",
        required: true,
        renderType: "number",
        defaultValue: 5,
      },
      {
        name: "sex",
        label: "성별",
        required: true,
        renderType: "dropdown",
        listItem: {
          list: [
            { label: "남", value: "Y", selected: true },
            { label: "여", value: "X" },
          ],
        },
      },
      {
        name: "cmpCredId",
        label: "credentials",
        renderType: "dropdown",
        required: true,
        listItem: {
          labelField: "credName",
          valueField: "credId",
          list: [{ label: "선택하세요." }, { credId: "credId", credName: "credName" }],
        },
        description: "",
      },
      {
        label: "주소",
        viewMode: "horizontal-row", // 'vertical , horizontal' ,horizontal-row
        name: "newAddress",
        // label: "신규주소여부",

        required: true,
        renderType: "checkbox",
        listItem: {
          list: [{ label: "Password Change", value: "Y", selected: true }],
        },
        onChange: (arg) => {
          console.log(arg);
        },

        children: [
          {
            name: "address32",
            label: "주소1",
            labelStyle: {
              align: "left",
              hide: true,
            },
            required: true,
            rule: {
              minLength: 2,
              maxLength: 100,
            },
            conditional: {
              show: false,
              field: "newAddress",
              eq: "Y",
              //custom?: OptionCallback
            },
          },
          {
            name: "address",
            label: "주소",
            hideLabel: true,
            required: true,
            labelStyle: {
              align: "right",
            },
            rule: {
              minLength: 2,
              maxLength: 100,
            },
            conditional: {
              show: true,
              custom: function () {
                return true;
              },
            },
          },
          {
            name: "address2",
            label: "주소1",
            labelStyle: {
              align: "left",
              hide: true,
            },
            required: true,
            rule: {
              minLength: 2,
              maxLength: 100,
            },
            conditional: {
              show: false,
              field: "newAddress",
              eq: "Y",
              //custom?: OptionCallback
            },
          },
          {
            renderType: "text",
            label: "주소 하위1",
            //childLabelWidth: "",
            viewMode: "horizontal", // 'vertical , horizontal, horizontal-row'
            labelStyle: {
              width: "200px",
            },
            conditional: {
              show: true,
              custom: function () {
                return true;
              },
            },
            children: [
              {
                name: "address22222",
                label: "주소1",
                labelWidth: "150px",
                renderType: "text",
              },
              {
                name: "address222333322",
                label: "주소2",
                renderType: "text",
              },
            ],
          },
          {
            label: "버튼",
            hideLabel: true,
            renderType: "button",
            onClick: (arg) => {
              console.log(arg);
            },
          },
        ],
      },
    ],
  };

  var rowIdx = 0;
  var formBuilder;
  var formObj = {
    load: () => {
      formBuilder = new DaraForm("#formArea", formInfo);
    },
    addItem: () => {
      rowIdx += 1;
      formBuilder.addField({
        name: `addItem${rowIdx}`,
        label: `추가컬럼${rowIdx}`,
        maxLength: 100,
        required: true,
      });
    },
    getValue: () => {
      alert(JSON.stringify(formBuilder.getValue()));
    },
    getValuePromise: () => {
      formBuilder
        .getFormDataValue(true)
        .then((aa) => {
          console.log(aa);

          for (let [name, value] of aa.entries()) {
            console.log(`${name} :  ${value}`);
          }

          alert("form data console 확인");
        })
        .catch((e) => {
          alert(e.message);
        });
    },
    setFieldItems: () => {
      formBuilder.setFieldItems("picture", [
        { fileId: "test1", fileName: "aaa.zip" },
        { fileId: "test2", fileName: "bbb.zip" },
      ]);
      formBuilder.setValue({ sex: "X" });
    },
  };
</script>
